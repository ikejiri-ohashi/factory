# Factory-app
https://www.factory-app.com
## 概要
金属製品の加工をお願いしたい企業とその加工が可能な企業を繋ぐサービスです。
ユーザーは加工の依頼を投稿したり、他の依頼を引き受けたりすることができます。
## 制作背景
前職で産業用機械の営業をしていたときに過去に納めたレーザー加工機に重大なトラブルが発生し、お客様の生産を完全にストップさせてしまったことがありました。

その生産の埋め合わせをするために代わりに加工をしてくれる業者を探しましたが
1件の取引先しか依頼のあてがなく、お客様の生産はさらに遅れてしまいました。

結果的にお客様は1ヶ月以上必要数の納品ができなくなる事態となり、
大変なご迷惑をおかけしてしまいました。

それ以来この問題をデジタルで解決するとしたらどんなサービスがあったら良いかを考えるようになり、
Factory-appはこれを具現化するために制作しました。

製造業や行政など成熟した業界にデジタルの影響を与えられるようなエンジニアになるのが今の目標です。
## 使用技術
- フロントエンド
  - HTML/CSS
  - Jquery
  - TailwindCSS
- バックエンド
  - Ruby(3.0.2)
  - Ruby on Rails(6.1.3)
  - MySQL(5.6)
  - Rubocop
  - Rspec(テスト)
- インフラ・開発環境
  - Docker/Docker-compose
  - AWS（ECR,ECS(EC2起動タイプ),VPC,S3,Route53,ALB,RDS,ACM）
  - CircleCI（自動テストのみ）
## 工夫したところ
- １、多くの機能を非同期通信を用いて高速化する
  - 投稿した依頼の編集・保存
  - プロフィールの編集・保存
  - トップページの依頼を探す・ユーザーを探す機能の切り替え
  - トップページの投稿・ユーザー検索の結果表示
  - フォロー、コメント、いいね、リクエスト送信それぞれの保存・削除
- ２、一度に作られるSQL文を非同期通信を用いて削減する
  - ユーザー詳細画面への遷移時にフォロー・フォロワーの情報は取得せず、タブが押された時のみ必要なSQL文を発行
  - ユーザー詳細画面にて投稿済み、お気に入り、発注済み、受注済みそれぞれ情報を4つのタブにし、それぞれのタブがクリックされたときに必要なSQL文を発行
## 苦労したところ
### N+1問題への対処
トップページには「あなたへのおすすめ」「あなたの地域の投稿」「その他の投稿一覧表示」の3段階で表示されて、この表示では多くの条件分岐が存在します。 
- その投稿はログインユーザー自身の投稿ではないか？
- その投稿は募集終了している投稿ではないか？
- その投稿は「あなたへのおすすめ」で表示されたか？
- その投稿は「あなたと同じ地域の投稿」で表示されたか？
これらの
- その投稿は「あなたと同じ地域の投稿」で表示されたか？

これらの条件に当てはまらないものが
## インフラ構成図
![infrastructure](https://user-images.githubusercontent.com/87586109/140628191-9540a03a-67f3-4472-bd12-fa15bdf0714b.png)
## ER図
![factory_er](https://user-images.githubusercontent.com/87586109/140602645-d39f045d-f4f6-415e-86ce-c692a2e8ceb5.png)
## 機能一覧
- ユーザー関連
  - ユーザー登録
  - ログイン機能(ゲストログイン機能あり)
  - プロフィール登録・編集
  - フォロー
- 投稿関連
  - 依頼投稿・編集・削除
  - お気に入り
  - コメント
  - 加工のリクエスト送信
  - 依頼の募集終了登録(契約済みの依頼として保存される)
  - 依頼検索
  - おすすめ依頼表示(ログインユーザーのプロフィール情報からマッチ度の高い依頼をおすすめとして表示する)
  - ユーザー検索
  - おすすめユーザー表示(ログインユーザーの投稿からマッチ度の高い他ユーザーをおすすめとして表示する)
  - お気に入り数ランキング
  - 募集終了した依頼の一覧表示
- その他
  - 非同期通信
  - レスポンシブデザイン
